
.. _program_listing_file__home_runner_work_Legion-Engine_Legion-Engine_legion_engine_core_filesystem_filemanip.hpp:

Program Listing for File filemanip.hpp
======================================

|exhale_lsh| :ref:`Return to documentation for file <file__home_runner_work_Legion-Engine_Legion-Engine_legion_engine_core_filesystem_filemanip.hpp>` (``/home/runner/work/Legion-Engine/Legion-Engine/legion/engine/core/filesystem/filemanip.hpp``)

.. |exhale_lsh| unicode:: U+021B0 .. UPWARDS ARROW WITH TIP LEFTWARDS

.. code-block:: cpp

   #pragma once
   #define _CRT_SECURE_NO_WARNINGS       // fopen vs fopen_s
   
   #include <core/platform/platform.hpp> // L_NODISCARD
   #include <core/types/types.hpp>       // byte, byte_vec
   #include <core/detail/internals.hpp>  // assert_msg
   
   #include <string_view>                // std::string_view
   #include <memory>                     // std::unique_ptr
   #include <cstdio>                     // fopen, fclose, fseek, ftell, fread, fwrite
   
   
   namespace legion::core::filesystem {
   
   
       L_NODISCARD inline bool exists(std::string_view path)
       {
           FILE* f = fopen(std::string(path).c_str(),"r+b");
   
           if(f)
           {
               fclose(f);
               return true;
           }
           return false;
       }
   
       L_NODISCARD inline  byte_vec read_file(std::string_view path)
       {
   
           //create managed FILE ptr
           const std::unique_ptr<FILE,decltype(&fclose)> file(
               fopen(std::string(path).c_str(),"r+b"),
               fclose // deleter is fclose
           );
   
           assert_msg("could not open file",file);
   
           //get size and create container of that size
           fseek(file.get(),0L,SEEK_END);
           byte_vec container(ftell(file.get()));
           fseek(file.get(),0L,SEEK_SET);
           
           //read file 
           fread(container.data(),sizeof(byte),container.size(),file.get());
   
           return container;
       }
   
       inline void write_file(std::string_view path,const byte_vec& container)
       {
   
           //create managed FILE ptr
           const std::unique_ptr<FILE,decltype(&fclose)> file(
               fopen(std::string(path).c_str(),"wb"),
               fclose
           );
   
           assert_msg("could not open file",file);
   
           // read data
           fwrite(container.data(),sizeof(byte),container.size(),file.get());
   
       }
   
   
       namespace literals
       {
           byte_vec LEGION_FUNC operator""_readfile(const char* str, std::size_t len);
   
           auto LEGION_FUNC operator""_writefile(const char* str, std::size_t len);
   
           bool LEGION_FUNC operator""_exists(const char* str, std::size_t len);
       }
   }
   
   #undef _CRT_SECURE_NO_WARNINGS
   
    //code example
   /*
   void example()
   {
       using namespace  legion::core::fs::literals;
   
       auto file1 = "hello_world.cpp"_readfile;
       auto file2 = legion::core::fs::read_file("hello_world.cpp");
   
       "hello_world2.cpp"_writefile(file2);
       legion::core::fs::write_file("hello_world2.cpp",file1);
   }
   */
